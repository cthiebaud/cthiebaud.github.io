function WAM2GAM(e){var t=function(e,t,n){return e!=null&&e.hasOwnProperty(t)?e[t]:n},n=function(e,t){var n=Array.prototype.slice.call(t);return n.unshift(e),n},r=t(e,"debug",!1),i=t(e,"localStorageProfileKey","webo_wam2gam_entry"),s=t(e,"ttl",9e5),o=t(e,"baseUrl","https://bsd.frontend.weborama.fr/bsd"),u=encodeURIComponent(t(e,"token","")),a=encodeURIComponent(t(e,"wamid","")),f=encodeURIComponent(t(e,"idcrm","")),l=t(e,"cookieless",!1),c=t(e,"useXdevice",!1),h=t(e,"useTokenInHeader",!1),p=t(e,"timeout",0),d=function(){var e=localStorage.getItem(i);if(!e)return m("nothing in local storage"),!0;var t=JSON.parse(e);if(typeof t!="object")return m("localStorage has something but it is not an object, deleting"),localStorage.removeItem(i),!0;if(!t.expiry)return m("localStorage has no expiry"),!0;var n=new Date;return n.getTime()>t.expiry},v=function(){try{var e=window.localStorage,t="__storage_test__";return e.setItem(t,t),e.removeItem(t),!0}catch(n){return m("local storage not available, skip"),!1}},m=function(){r&&console.log.apply(console,n("[weborama wam2gam]",arguments))};this.getTargeting=function(){if(!v())return;var e=localStorage.getItem(i);if(!e){m("unable to update GAM: find nothing on local storage");return}var t=JSON.parse(e);if(typeof t!="object"){m("unable to update GAM: bad item, not an object, should remove key",i),localStorage.removeItem(i);return}var n=t.targeting;if(typeof n!="object"){m("unable to update GAM: bad targeting, not an object, should remove key",i),localStorage.removeItem(i);return}return n},this.clearCache=function(){if(!v())return;m("clear targeting from localStorage"),localStorage.removeItem(i)};var g=function(e){if(!e)return;if(!v())return;var t={},n="custom_segments",r="audiences",o="webo_cs",u="webo_audiences";e[n]&&(t[o]=e[n]),e[r]&&(t[u]=e[r]);var a=new Date,f={targeting:t,expiry:a.getTime()+s};m("localStorage.setItem",i,"with targeting",f),localStorage.setItem(i,JSON.stringify(f))},y=function(e){var t="GET",n=new XMLHttpRequest;n.open(t,e),l||(n.withCredentials=!0),h&&(n.setRequestHeader("X-Weborama-BSD-Token",u),m("set bsd token on header")),p&&(n.timeout=p),n.onreadystatechange=function(){if(this.readyState==n.DONE){var e={};this.status==200&&(e=JSON.parse(this.responseText)),g(e)}},n.ontimeout=function(){m("timeout in ajax call to bsd api")},n.onerror=function(){m("error in ajax call to bsd api")},n.send(null),m("calling url via ajax",e)};this.updateLocalTargeting=function(e){if(!u){m("missing bsd token, skip");return}l&&(!a||!f)&&m("missing wamid and crmid on cookieless option, it will only work with first party id");if(c&&!a){m("missing wamid on useXdevice option, skip");return}if(!v())return;if(!d()){m("localStorage cache still valid, skip");return}var t=[];h?headers={"X-Weborama-BSD-Token":u}:t.push(["token",u]),a&&t.push(["wamid",a]),f&&t.push(["idcrm",f]),c&&t.push(["useXdevice",1]),l&&o.indexOf("cookieless=1")==-1?t.push(["cookieless",1]):l||t.push(["nbnc",1]);var n=[];for(var r in t){var i=t[r];n.push(i.join("="))}var s=o.indexOf("?")>0?"&":"?",p=o+s+n.join("&");return e(p,y)}}function WeboFirstPartyCookieManager(e){var t=function(){var e=navigator.cookieEnabled?!0:!1,t=navigator.userAgent.toLowerCase(),n=t.indexOf("msie")!==-1||t.indexOf("trident")!==-1,r="__wtestcookie";if(navigator.cookieEnabled===undefined||n)document.cookie=r,e=document.cookie.indexOf(r)!==-1?!0:!1;return e},n=t(),r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789@-",s=function(e){return Math.floor(Math.random()*e)},o=new Date(0),u=function(e,t,n,r,i,s,o){var u=e+"="+escape(t)+(n?"; expires="+n.toGMTString():"")+(r?"; path="+r:"")+(i?"; domain="+i:"")+(s?"; secure":"")+(o?"; SameSite="+o:"");document.cookie=u},a=function(e,t,n){var r,i,a="__wtest_top_domain",f=a,l=document.location.hostname.split(".");while(document.cookie.indexOf(f)>-1)f=a+s(1e5);for(r=l.length-2;r>=0;r--){i=l.slice(r).join("."),u(f,1,null,e,i,t,n);if(document.cookie.indexOf(f)>-1)return u(f,"",o,e,i,t,n),i}},f=null,l=function(e,t,n,r,i,s,o){i==="auto"&&(f==null&&(f=a(r,s,o)),i=f),u(e,t,n,r,i,s,o)},c=function(e,t,n){return e!=null&&e.hasOwnProperty(t)?e[t]:n},h="cookie",p=c(e,h+"Name","AFFICHE_C"),d=c(e,h+"TTL",7776e6),v=c(e,h+"Path","/"),m=c(e,h+"Domain","auto"),g=c(e,h+"Secure",!1),y=c(e,h+"SameSite","Strict"),b=c(e,"shouldRefreshCookie",!1),w=c(e,"firstPartyIDQueryArg","fpid"),E=c(e,"cookieless",!1),S=function(e){var t=e+"=",n=t.length,r=document.cookie.length,i=0;while(i<r){var s=i+n;if(document.cookie.substring(i,s)==t){var o=s,u=document.cookie.indexOf(";",o);return u==-1&&(u=document.cookie.length),unescape(document.cookie.substring(o,u))}i=document.cookie.indexOf(" ",i)+1;if(i==0)break}return null},x=function(e){var t=new Date;t.setTime(t.getTime()+d),l(p,e,t,v,m,g,y)},T=function(){l(p,"",o,v,m,g,y)},N=function(){var e=S(p);if(e==null)return null;if(e.length!=14)return T(),null;var t=e.charAt(0);if(t=="@"||t=="!"||t=="_")return T(),null;var n=new RegExp("[^"+r+"]");return n.test(e)?(T(),null):e},C=function(){var e=[],t=s(256);while(t>=248&&t<=251)t=s(256);e[0]=t;for(i=1;i<8;i++)e[i]=s(256);e[8]=t;var n=String.fromCharCode.apply(null,e),r=btoa(n).replaceAll("+","@").replaceAll("/","-");return r+String.fromCharCode(s(9)+49)+String.fromCharCode(s(10)+48)},k=function(e){var t=e.indexOf("?");return t!=-1&&(e=e.substring(0,t)),e.indexOf("weborama.fr")};this.getFirstPartyCookie=function(){if(!n)return null;var e=N();return e==null?(e=C(),x(e)):b&&x(e),e},this.executeCallback=function(e){var t=this.getFirstPartyCookie();e(t,n,m)},this.decorateURL=function(e){if(!k(e))return e;var t=e.indexOf("?")>0?"&":"?",n=this.getFirstPartyCookie();return n!=null&&(e+=t+w+"="+n,E&&e.indexOf("cookieless=1")==-1&&(e+="&cookieless=1")),e}}function WeboCtx(){var e=function(e,t,n){return e!=null&&e.hasOwnProperty(t)?e[t]:n},t=function(e,t){var n=Array.prototype.slice.call(t);return n.unshift(e),n};this.push=function(){for(var e=0;e<arguments.length;e++)try{if(typeof arguments[e]=="function"){var t=arguments[e].bind(this);t()}}catch(n){console.log("WeboCtx.push exception",n)}},this.collectURL=function(n){var r=e(n,"debug",!1),i=function(){r&&console.log.apply(console,t("[weboCtx/collect]",arguments))};if(!n){i("skip collect url: missing configuration");return}if(!n.clientID){i("skip collect url: missing client id");return}var s="https://dx.frontend.weborama.com/collect",o=encodeURIComponent(n.clientID),u=e(n,"targetURL",document.URL),a=s+"?ctx=1&touchpoint="+o+"&url="+encodeURIComponent(u),f=new XMLHttpRequest;i("connect to",s,"to collect url",u),f.open("GET",a,!0),f.onreadystatechange=function(){this.readyState==f.DONE&&i("url collect api done with status",this.status)},f.ontimeout=function(){i("timeout url collect api: ",s)},f.onerror=function(){i("error url collect api: ",s)},f.send(null)},this.fetchContextualProfile=function(n){var r=e(n,"debug",!1),i=function(){r&&console.log.apply(console,t("[weboCtx/fetch]",arguments))},s=function(e,t,n){var r=n;typeof t=="string"&&(r=t),i("set profile on global variable window.",r),window[r]=e},o=function(e){window.googletag=window.googletag||{cmd:[]},googletag.cmd.push(function(){for(var t in e){var n=e[t];i("setTargeting on page level, key: ",t,", value: ",n),googletag.pubads().setTargeting(t,n)}})};if(!n){i("skip fetch contextual data: missing configuration");return}if(!n.token){i("skip fetch contextual data: missing token");return}var u="https://ctx.weborama.com/api/profile",a="weboCtxProfile",f=encodeURIComponent(n.token),l=e(n,"targetURL",document.URL),c=e(n,"timeout",1e3),h=e(n,"defaultProfile",{}),p=e(n,"useGlobalVariable",!0),d=e(n,"setTargeting",!1),v=n.callback,m=u+"?token="+f+"&url="+encodeURIComponent(l),g=new XMLHttpRequest;i("connect to",u," to fetch contextual profile of url",l),g.open("GET",m,!0),c>0&&(g.timeout=c),g.onreadystatechange=function(){if(this.readyState==g.DONE){var e=h;if(this.status==200){var t={};try{t=JSON.parse(this.responseText)||{}}catch(n){i("unable to parse api response",this.responseText,n)}var r="webo_ctx",u="webo_ds";t.hasOwnProperty("webo_ctx")&&(e[r]=t.webo_ctx),t.hasOwnProperty("webo_ds")&&(e[u]=t.webo_ds),i("contextual api: success",e)}else i("contextual api: unexpected status code ",this.status," use default profile");!p||s(e,p,a),!d||o(e),typeof v=="function"&&(i("send profile to callback"),v(e))}},g.ontimeout=function(){i("timeout contextual api: ",u)},g.onerror=function(){i("error contextual api: ",u)},g.send(null)}}(function(){if(typeof window.__tcfapi=="function")return;var e=function(e){var t=window,n=null;while(!n){try{t.frames[e]&&(n=t)}catch(r){}if(t===window.top)break;t=t.parent}return n},t,n,r={};if(!(t=e("__tcfapiLocator")))return;n="__tcfapiReturn",window.__tcfapi=function(e,n,i,s){var o=Math.random()+"",u={__tcfapiCall:{command:e,parameter:s,version:n,callId:o}};r[o]=i,t.postMessage(u,"*")};var i=function(e){var t={};try{t=typeof e.data=="string"?JSON.parse(e.data):e.data}catch(i){}var s=t[n];s&&typeof r[s.callId]=="function"&&(r[s.callId](s.returnValue,s.success),delete r[s.callId])};window.addEventListener("message",i,!1)})();var _old_weboCtx=window.weboCtx||[];window.weboCtx=new WeboCtx,window.weboCtx.push.apply(window.weboCtx,_old_weboCtx),window.wamf=function(){return{version:"20220203_01",cookieless:null,firstPartyCookieConf:{},enableFirstPartyCookie:!1,firstPartyCookieManager:null,account:function(e){typeof e=="string"&&/^\d+$/.test(e)===!0?this.account=e:this.account=""},querytyp:function(e){typeof e=="string"&&/^\d+$/.test(e)===!0?this.typ=e:this.typ=""},enableFirstParty:function(e){this.enableFirstPartyCookie=e},firstPartConf:function(e){this.cookieless!=null&&(e.cookieless=this.cookieless),this.firstPartyCookieConf=e},setCookieless:function(e){this.cookieless=e},eventkey:function(e){typeof e=="string"?this.ekey=e:this.ekey=""},eventvalue:function(e){typeof e=="string"?this.evalue=e:this.evalue=""},pushWvar:function(e){if(e.constructor===Array){function t(e){var t=[],n=e.length;for(var r=0;r<n;r++){for(var i=r+1;i<n;i++)e[r]===e[i]&&(i=++r);t.push(e[r])}return t}if(e[0].match(/(.*):(.*)/)===null){var n=[],r="",i=0;for(i=0;i<e.length;i++)i%2===1?(r+=e[i],n.push(r)):r=e[i]+":";e=n}e=t(e),e.sort();var s=[],o=[],u=[],a="",f="",l="",c=0,h=0,p=0;e:for(h=0;h<e.length;h++){o=e[h].match(/(.*):/);while(o[1].indexOf(":")>0)Wkktmp=o[1].match(/(.*):/),o[1]=Wkktmp[1];for(var p=0;p<s.length;p++)if(s[p]==o[1])continue e;s.push(o[1])}for(h=0;h<s.length;h++){h==0?f='{"'+s[h]+'":':f+='"'+s[h]+'":',a="",l="",c=0;for(p=0;p<e.length;p++){o=e[p].match(/(.*):/);while(o[1].indexOf(":")>0)Wkktmp=o[1].match(/(.*):/),o[1]=Wkktmp[1];u=e[p].match(/:(.*)/),a=o[1],a==o[1]&&o[1]==s[h]&&(l==""?l='"'+u[1]+'"':(l+=',"'+u[1]+'"',c++))}c>0&&(l="["+l+"]"),h+1==s.length?f+=l+"}":f+=l+","}this.Wvar=JSON.parse(f)}else this.Wvar=e},_decorateURL:function(e){return this.enableFirstPartyCookie?(this.firstPartyCookieManager==null&&(this.firstPartyCookieManager=new WeboFirstPartyCookieManager(this.firstPartyCookieConf)),this.firstPartyCookieManager.decorateURL(e)):e},_create_element_of_given_type:function(e,t,n){if(e=="image"){var r=new Image;r.src=t,r.onload=function(){return}}else if(e=="script"){var i=document.createElement("script");i.type="text/javascript",i.src=t;var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(i,s)}else if(e=="callback")n(t);else{var r=document.createElement("iframe");r.setAttribute("id","Wifrm"),document.body.appendChild(r),r.setAttribute("src",t),r.setAttribute("style","height: 1px; width: 1px; border: 0px none; position: absolute; display: none; left: 0px; top: 0px; z-index: 0;")}},send_after_cmp_check:function(e,t,n){if(this.cookieless&&t.indexOf("weborama.fr")>0&&t.indexOf("cookieless=1")==-1){var r=t.indexOf("?")>0?"&":"?";t+=r+"cookieless=1"}if(typeof window.__tcfapi=="function"){var s=this;window.__tcfapi("getTCData",2,function(r,o){var u=function(e,t){for(i in t)if(t.hasOwnProperty(i)&&!e.purpose.consents[t[i]])return!1;return!0},a=function(e){return u(e,[1,3,4])&&e.vendor.consents[284]};t+=t.indexOf("?")==-1?"?":"&";if(!o)t+="gdpr=1&gdpr_cmp_failure=1",t=s._decorateURL(t);else if(!r.gdprApplies)t+="gdpr=0",t=s._decorateURL(t);else{if(r.eventStatus!=="useractioncomplete"&&!u(r,[1,3,4])){window.__tcfapi("addEventListener",2,function(r,i){i&&r!=null&&r.eventStatus=="useractioncomplete"&&(window.__tcfapi("removeEventListener",2,function(){},r.listenerId),t+="gdpr=1&gdpr_consent="+(r.tcString||""),r.vendor.consents[284]&&(t=s._decorateURL(t)),s._create_element_of_given_type(e,t,n))});return}t+="gdpr=1&gdpr_consent="+(r.tcString||""),a(r)&&(t=s._decorateURL(t))}s._create_element_of_given_type(e,t,n)})}else this._create_element_of_given_type(e,this._decorateURL(t),n)},__getDomainPrefix:function(){var e="wf";if(2510==this.account)e="lbcwf";else if(1869==this.account||2337==this.account||2548==this.account||2887==this.account||3793==this.account||4197==this.account||4669==this.account||4702==this.account||6787==this.account||6949==this.account||7424==this.account||8058==this.account||8645==this.account)e="wf-ru";return e},pageSend:function(){var e;typeof this.Wvar!="object"?e={}:e=this.Wvar;if(this.account!=""&&this.typ!=""){e.wamid=this.account,e.typ=this.typ,e.url=encodeURIComponent(document.URL),e.ref=encodeURIComponent(document.referrer),WvarPageStr=encodeURIComponent(JSON.stringify(e)),WvarPageStr.length>1900&&(e.ref="",WvarPageStr=encodeURIComponent(JSON.stringify(e)));var t=this.__getDomainPrefix();this.send_after_cmp_check("image","https://"+t+".frontend.weborama.fr/stream/?wamid="+this.account+"&Wvar="+WvarPageStr+"&d.r="+(new Date).getTime())}},eventSend:function(e,t,n,r){window.wamf.querytyp(e),window.wamf.eventkey(t),window.wamf.eventvalue(n),typeof this.Wvar!="object"?WvarEvent={}:WvarEvent=this.Wvar;if(this.account!=""&&this.typ!=""&&this.ekey!=""&&this.evalue!=""){WvarEvent.wamid=this.account,WvarEvent.typ=this.typ,WvarEvent[this.ekey]=this.evalue,WvarEvent.url=encodeURIComponent(document.URL),WvarEvent.ref=encodeURIComponent(document.referrer),WvarEventStr=encodeURIComponent(JSON.stringify(WvarEvent)),WvarEventStr.length>1900&&(WvarEvent.ref="",WvarEventStr=encodeURIComponent(JSON.stringify(WvarEvent)));var i=this.__getDomainPrefix();this.send_after_cmp_check("image","https://"+i+".frontend.weborama.fr/stream/?wamid="+this.account+"&Wvar="+WvarEventStr+"&d.r="+(new Date).getTime())}},sync:function(e){if(e!=0&&this.cookieless!=="true"){var t=["key=ids_sync","wamid="+this.account,"src=wamf.wildcard.js","ref="+encodeURIComponent(document.location.host),"d.r="+(new Date).getTime()],n=t.join("&"),r=(e==2?"external":"sync")+".html",i="https://cstatic.weborama.fr/iframe/"+r+"?"+n;this.send_after_cmp_check("iframe",i)}},wam2gamObj:null,wam2gamObjConf:{instanceName:"window.wamf"},wam2gamConf:function(e){this.wam2gamObjConf.wamid=this.account,this.cookieless!=null&&(e.cookieless=this.cookieless);for(var t in e)this.wam2gamObjConf[t]=e[t]},wam2gam:function(){return this.wam2gamObj==null&&(this.wam2gamObj=new WAM2GAM(this.wam2gamObjConf)),this.wam2gamObj},clearCache:function(){return this.wam2gam().clearCache()},storeTargeting:function(e){return this.wam2gam().storeTargeting(e)},getTargeting:function(){return this.wam2gam().getTargeting()},updateLocalTargeting:function(){var e=this;return this.wam2gam().updateLocalTargeting(function(t,n){e.send_after_cmp_check("callback",t,n)})},data:[],push:function(e,t){this.data.push(e.toString()),this.data.push(t.toString())},send:function(){window.wamf.pushWvar(this.data),window.wamf.pageSend()}}}(),typeof WeboCtxConf!="undefined"&&(window.weboCtx=window.weboCtx||[],weboCtx.push(function(){this.fetchContextualProfile(WeboCtxConf)})),typeof window.wamf_callback=="undefined"&&(typeof wamid=="undefined"&&(wamid=""),typeof typ=="undefined"&&(typ="1"),typeof Wvar=="undefined"&&(Wvar=""),typeof Wsync=="undefined"&&(Wsync=1),window.wamf.account(wamid),window.wamf.querytyp(typ),typeof Wcookieless!="undefined"&&window.wamf.setCookieless(!!Wcookieless),typeof WfirstParty!="undefined"&&window.wamf.enableFirstParty(!!WfirstParty),typeof WfirstPartyConf!="undefined"&&window.wamf.firstPartConf(WfirstPartyConf),typeof Wam2gamConf!="undefined"&&(window.wamf.wam2gamConf(Wam2gamConf),window.wamf.updateLocalTargeting()),window.wamf.pushWvar(Wvar),window.wamf.pageSend(),window.wamf.sync(Wsync)),typeof window.wamf_callback=="function"&&(window.wamf_callback(),window.wamf_callback=function(){window.wamf.querytyp("1"),window.wamf.sync(2)});